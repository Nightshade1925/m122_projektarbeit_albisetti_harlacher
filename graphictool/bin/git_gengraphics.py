#!/usr/bin/env python3
# Python program to illustrate
# Plotting categorical scatter
# plots with Seaborn

# importing the required module
import logging

try:
    import seaborn as sns
    import matplotlib.pyplot as plt
    import pandas as pd
    import matplotlib.ticker as ticker
    from matplotlib.dates import DateFormatter
except ImportError as err:
    print("seaborn was not installed. use installseaborn.sh to install a virtualenv including seaborn")
    logging.exception(err)
    exit(1)

import argparse

parsarguments = argparse.ArgumentParser(description='''
This is a script which generates from a csv file containing commits, which was generated by git_ectract_commits.bash
a stripplot graphic.
''')
parsarguments.add_argument('--csvfile', '-c', required=True, type=argparse.FileType('r'),
                           help="Commaseparated file with commits")
parsarguments.add_argument('--outputfile', '-o', required=True, type=str,
                           help='Filename of outputfile for png')
args = parsarguments.parse_args()

rc = {
    'legend.fontsize': 5,
    'xtick.labelsize': 5,
    'ytick.labelsize': 5}
sns.set(rc=rc)

# x axis values
data = pd.read_csv(args.csvfile,parse_dates=[1])

# plotting strip plot with seaborn
ax = sns.stripplot(x='Datum', y='Zielverzeichnis', hue='Author', data=data, orient="h",size=2);

box = ax.get_position()
ax.set_position([box.x0, box.y0, box.width * 0.85, box.height])  # resize position

# Put a legend to the right side
ax.legend(loc='center right', bbox_to_anchor=(1.25, 0.5), ncol=1)

ax.xaxis.set_major_formatter(DateFormatter("%Y-%m-%d"))

# giving title to the plot
plt.title('Git-Activity-Diagram')

# function to show plot
plt.savefig(args.outputfile, dpi=200)
